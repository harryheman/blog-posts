# `React + Rust` :metal:

Let's use `Wasm` module, compiled from `Rust`, in `React`.

–ù–∞ –¥–Ω—è—Ö –ø—Ä–æ—á–∏—Ç–∞–ª [–∏–Ω—Ç–µ—Ä–µ—Å–Ω—É—é —Å—Ç–∞—Ç—å—é](https://www.joshfinnie.com/blog/using-webassembly-created-in-rust-for-fast-react-components/), –≤ –∫–æ—Ç–æ—Ä–æ–π –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è [`WebAssembly-–º–æ–¥—É–ª–µ–π`](https://developer.mozilla.org/ru/docs/WebAssembly) (–¥–∞–ª–µ–µ - `Wasm`), —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏–∑ [`Rust`](https://www.rust-lang.org), –≤ [`React-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏`](https://ru.reactjs.org/).

–¢–∞–∫ –≤–æ—Ç, —Å—Ç–∞—Ç—å—è –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è, –Ω–æ –∞–≤—Ç–æ—Ä —Ç–æ–ª–∫–æ–º –Ω–∏—á–µ–≥–æ –Ω–µ –æ–±—ä—è—Å–Ω—è–µ—Ç, –≤–∏–¥–∏–º–æ, –∏—Å—Ö–æ–¥—è –∏–∑ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏—è, —á—Ç–æ —á–∏—Ç–∞—Ç–µ–ª–∏, –∫–∞–∫ –∏ –æ–Ω, –≤–ª–∞–¥–µ—é—Ç –æ–±–æ–∏–º–∏ —è–∑—ã–∫–∞–º–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è (`JavaScript` –∏ `Rust`).

–ü–æ—Å–∫–æ–ª—å–∫—É —è –Ω–µ –æ—Ç–Ω–æ—à—É—Å—å –∫ —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–ø–æ–∫–∞ –Ω–µ –∑–Ω–∞—é `Rust`), –Ω–æ –ª—é–±–ª—é –∫–∞–∫ —Å–ª–µ–¥—É–µ—Ç —Ä–∞–∑–±–∏—Ä–∞—Ç—å—Å—è –≤ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏—Ö –º–µ–Ω—è –≤–µ—â–∞—Ö, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é –≤–∞—à–µ–º—É –≤–Ω–∏–º–∞–Ω–∏—é —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é.

[–ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –ø—Ä–æ–µ–∫—Ç–∞](https://github.com/harryheman/react-rust).

–ï—Å–ª–∏ –≤–∞–º —ç—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ, –ø—Ä–æ—à—É –ø–æ–¥ –∫–∞—Ç.
<cut />

–ï—Å–ª–∏ –≤—ã –≤–ø–µ—Ä–≤—ã–µ —Å–ª—ã—à–∏—Ç–µ –æ `Wasm`, [–≤–æ—Ç —Å—Ç–∞—Ç—å—è, –≤ –∫–æ—Ç–æ—Ä–æ–π –æ—Å–≤–µ—â–∞—é—Ç—Å—è –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –Ω–∏–º –æ–±—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã](https://habr.com/ru/company/timeweb/blog/589793/).

–ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è, —á—Ç–æ –≤—ã –∑–Ω–∞–∫–æ–º—ã —Å `React.js`, –∏–º–µ–µ—Ç–µ –æ–±—â–µ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ [`Node.js`](https://nodejs.org/en/) –∏ —Ö–æ—Ç—è –±—ã —Ä–∞–∑ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–ª–∏ –∫–∞–∫–æ–π-–Ω–∏–±—É–¥—å —Å–±–æ—Ä—â–∏–∫ –º–æ–¥—É–ª–µ–π —Ç–∏–ø–∞ [`Webpack`](https://webpack.js.org/) (—è –±—É–¥—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å [`Snowpack`](https://www.snowpack.dev/)).

–†–∞–∑—É–º–µ–µ—Ç—Å—è, –Ω–∞ –≤–∞—à–µ–π –º–∞—à–∏–Ω–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω [`Node.js`](https://nodejs.org/en/) –∏ [`Rust`](https://www.rust-lang.org/tools/install).

–ù–∞ `Mac` —ç—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è —Ç–∞–∫:

```bash
# —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Node.js
brew install node@16 # lts –≤–µ—Ä—Å–∏—è
# —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Rust
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
```

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

–°–æ–∑–¥–∞–µ–º —à–∞–±–ª–æ–Ω `React-–ø—Ä–æ–µ–∫—Ç–∞` —Å –ø–æ–º–æ—â—å—é `Snowpack`:

```bash
# react-rust - –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
# --template @snowpack/app-template-react - –Ω–∞–∑–≤–∞–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ —à–∞–±–ª–æ–Ω–∞
# --use-yarn - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å yarn –≤–º–µ—Å—Ç–æ npm –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
yarn create snowpack-app react-rust --template @snowpack/app-template-react --use-yarn
# –∏–ª–∏
npx create-snowpack-app ...
```

–ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ —Å–æ–∑–¥–∞–Ω–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º `Rust-–ø—Ä–æ–µ–∫—Ç`:

```bash
# –ø–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
cd react-rust
# –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—Ä–æ–µ–∫—Ç
cargo init --lib
```

[`Cargo`](https://doc.rust-lang.org/cargo/index.html) - —ç—Ç–æ –ø–∞–∫–µ—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä (package manager) `Rust` (–∞–Ω–∞–ª–æ–≥ `npm`, –≤—Ö–æ–¥–∏—Ç –≤ —Å–æ—Å—Ç–∞–≤ `Rust`). –û–Ω —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç –ø–∞–∫–µ—Ç—ã, —Å–æ–∑–¥–∞–µ—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ–º—ã–µ –ø–∞–∫–µ—Ç—ã –∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏—Ö –≤ [`crates.io`](https://crates.io/) (—Ä–µ–µ—Å—Ç—Ä –ø–∞–∫–µ—Ç–æ–≤ `Rust`, –∞–Ω–∞–ª–æ–≥ `npmjs.com`).

–ö–æ–º–∞–Ω–¥–∞ [`cargo init`](https://doc.rust-lang.org/cargo/commands/cargo-init.html) —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π –ø–∞–∫–µ—Ç –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏. –§–ª–∞–≥ `--lib` —Å–æ–∑–¥–∞–µ—Ç –ø–∞–∫–µ—Ç —Å —Ü–µ–ª–µ–≤–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π (`src/lib.rs`, —Ñ–∞–π–ª—ã —Å –∫–æ–¥–æ–º –Ω–∞ `Rust`, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –∏–º–µ—é—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ `rs`). [–¶–µ–ª–µ–≤–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞](https://doc.rust-lang.org/cargo/reference/cargo-targets.html#library) - —ç—Ç–æ "–±–∏–±–ª–∏–æ—Ç–µ–∫–∞", –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –¥—Ä—É–≥–∏–º–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏ –∏ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏ (executables). –û–¥–∏–Ω –ø–∞–∫–µ—Ç –º–æ–∂–µ—Ç –∏–º–µ—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω—É –±–∏–±–ª–∏–æ—Ç–µ–∫—É.

`cargo` –Ω–µ —É–º–µ–µ—Ç –∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å `Rust` –≤ `Wasm`. –î–ª—è —ç—Ç–æ–≥–æ –Ω–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–∞–∫–µ—Ç [`wasm-bindgen`](https://github.com/rustwasm/wasm-bindgen) (–¥–∞–Ω–Ω—ã–π –ø–∞–∫–µ—Ç –≤—Ö–æ–¥–∏—Ç –≤ —Å–æ—Å—Ç–∞–≤ [`wasm-pack`](https://github.com/rustwasm/wasm-pack)).

–û–Ω, –≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å "–≤–µ—â–∏" –∏–∑ `JavaScript` –≤ `Rust` –∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å "–≤–µ—â–∏" –∏–∑ `Rust` –≤ `JavaScript` (—Ü–∏—Ç–∞—Ç–∞ –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏).

–¢–∞–∫–∂–µ –Ω–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–æ–±—â–∏—Ç—å –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä—É, —á—Ç–æ —Ç–∏–ø–æ–º –ø–∞–∫–µ—Ç–∞ —è–≤–ª—è–µ—Ç—Å—è [`cdylib`](https://github.com/rust-lang/rfcs/blob/master/text/1510-cdylib.md). –£–∫–∞–∑–∞–Ω–∏–µ [`cdylib`](https://doc.rust-lang.org/reference/linkage.html) –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π —Å–∏—Å—Ç–µ–º–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (dynamic system library). –≠—Ç–æ—Ç —Ç–∏–ø –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è "–ø—Ä–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, –∑–∞–≥—Ä—É–∂–∞–µ–º–æ–π –∏–∑ –¥—Ä—É–≥–æ–≥–æ —è–∑—ã–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è".

–†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º [`Cargo.toml`](https://doc.rust-lang.org/cargo/reference/manifest.html) (–∞–Ω–∞–ª–æ–≥ `package.json`, —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ `Rust-–ø—Ä–æ–µ–∫—Ç–∞`):

```bash
[package]
name = "react-rust"
version = "1.0.0"
edition = "2021"

[lib]
crate-type = ["cdylib"]

[dependencies]
wasm-bindgen = "0.2"
```

–í—ã–ø–æ–ª–Ω—è–µ–º —Å–±–æ—Ä–∫—É `Rust-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è`:

```bash
cargo build # –¥–∞–Ω–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç –ø–∞–∫–µ—Ç—ã –∏ –≤—Å–µ –∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```

–≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `target`. –í –Ω–µ–π –ø–æ–∫–∞ –Ω–µ—Ç –Ω–∏—á–µ–≥–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–≥–æ, –Ω–æ —Å–∫–æ—Ä–æ –º—ã —ç—Ç–æ –∏—Å–ø—Ä–∞–≤–∏–º.

–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã —Å–±–æ—Ä–∫–∞ —Å–æ–¥–µ—Ä–∂–∞–ª–∞ `Wasm-—Ñ–∞–π–ª`, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —è–≤–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ü–µ–ª—å —Å–±–æ—Ä–∫–∏:

```bash
rustup target add wasm32-unknown-unknown
```

[`rustup`](https://rust-lang.github.io/rustup/) - —ç—Ç–æ —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫ –Ω–∞–±–æ—Ä–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (toolchain installer) `Rust`. [`target add`](https://rust-lang.github.io/rustup/cross-compilation.html) –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ü–µ–ª—å –∫–æ–º–ø–∏–ª—è—Ü–∏–∏.

–ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç `wasm32-unknown-unknown`? –ü–µ—Ä–≤—ã–π `unknown` –æ–∑–Ω–∞—á–∞–µ—Ç —Å–∏—Å—Ç–µ–º—É, –≤ –∫–æ—Ç–æ—Ä–æ–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–æ–º–ø–∏–ª—è—Ü–∏—è, –≤—Ç–æ—Ä–æ–π - —Å–∏—Å—Ç–µ–º—É, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–æ–º–ø–∏–ª—è—Ü–∏—è. `wasm32` –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ [–∞–¥—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ](https://ru.wikipedia.org/wiki/%D0%90%D0%B4%D1%80%D0%B5%D1%81%D0%BD%D0%BE%D0%B5_%D0%BF%D1%80%D0%BE%D1%81%D1%82%D1%80%D0%B0%D0%BD%D1%81%D1%82%D0%B2%D0%BE_(%D0%B8%D0%BD%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%82%D0%B8%D0%BA%D0%B0)) –∏–º–µ–µ—Ç —Ä–∞–∑–º–µ—Ä 32 –±–∏—Ç–∞ ([–∏—Å—Ç–æ—á–Ω–∏–∫](https://github.com/rustwasm/wasm-bindgen/issues/979)).

–†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º `src/lib.rs` (–≤–æ–∑—å–º–µ–º –ø—Ä–∏–º–µ—Ä –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ `wasm-bindgen`):

```rust
// –∏–º–ø–æ—Ä—Ç –ø–∞–∫–µ—Ç–∞
// https://doc.rust-lang.org/beta/reference/names/preludes.html
// https://stackoverflow.com/questions/36384840/what-is-the-prelude
use wasm_bindgen::prelude::*;

// –∏–º–ø–æ—Ä—Ç —Ñ—É–Ω–∫—Ü–∏–∏ `window.alert` –∏–∑ "–í–µ–±–∞"
#[wasm_bindgen]
extern "C" {
 fn alert(s: &str);
}

// —ç–∫—Å–ø–æ—Ä—Ç —Ñ—É–Ω–∫—Ü–∏–∏ `greet` –≤ JavaScript
#[wasm_bindgen]
pub fn greet(name: &str) {
 alert(&format!("Hello, {}!", name));
}
```

–í—ã–ø–æ–ª–Ω—è–µ–º —Å–±–æ—Ä–∫—É `Rust-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è`, —É–∫–∞–∑—ã–≤–∞—è –Ω—É–∂–Ω—É—é —Ü–µ–ª—å:

```bash
cargo build --target wasm32-unknown-unknown
```

–≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–µ–≥–æ –Ω–∞—Å —Ñ–∞–π–ª–∞ `target/wasm32-unknown-unknown/debug/react_rust.wasm`. `debug` –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º—ã –≤—ã–ø–æ–ª–Ω–∏–ª–∏ —Å–±–æ—Ä–∫—É –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏. –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–¥–∞–∫—à-—Å–±–æ—Ä–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–∞ `cargo build --release` (–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥—ã –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `target/wasm32-unknown-unknown/release`).

–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–ª–∞–≥–∏–Ω [`@emily-curry/snowpack-plugin-wasm-pack`](https://www.npmjs.com/package/@emily-curry/snowpack-plugin-wasm-pack). –î–∞–Ω–Ω—ã–π –ø–ª–∞–≥–∏–Ω –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ–±–µ—Ä—Ç–∫—É –¥–ª—è `Wasm`, —Å–æ—Å—Ç–æ—è—â—É—é –∏–∑ –Ω–∞–±–æ—Ä–∞ `JS` –∏ `TS-—Ñ–∞–π–ª–æ–≤`, –≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, `index.js`, —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é—â–µ–≥–æ —Ñ—É–Ω–∫—Ü–∏—é `greet`, –∫–æ—Ç–æ—Ä—É—é –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ `React-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏`.

–†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º `snowpack.config.mjs`:

```javascript
export default {
 mount: {
   public: { url: '/', static: true },
   src: { url: '/dist' },
   // —ç—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª—ã –∏–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ pkg,
   // –Ω–∞—Ö–æ–¥—è—â–µ–π—Å—è –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ src
   pkg: { url: '/pkg' }
 },
 plugins: [
   '@snowpack/plugin-react-refresh',
   '@snowpack/plugin-dotenv',
   // –ø–ª–∞–≥–∏–Ω –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–±–µ—Ä—Ç–∫–∏
   [
     '@emily-curry/snowpack-plugin-wasm-pack',
     {
       // –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ø—Ä–æ–µ–∫—Ç–∞, —Å–æ–¥–µ—Ä–∂–∞—â–∞—è —Ñ–∞–π–ª Cargo.toml
       projectPath: '.'
     }
   ]
 ],
 // ...
```

–î–ª—è —Ä–∞–±–æ—Ç—ã –ø–ª–∞–≥–∏–Ω–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è [`cargo-watch`](https://github.com/watchexec/cargo-watch) –∏ [`wasm-pack`](https://github.com/rustwasm/wasm-pack). `wasm-pack` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∫–∞–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å `wasm-bindgen`.

`cargo-watch` –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã `cargo` –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ñ–∞–π–ª–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞ (–∞–Ω–∞–ª–æ–≥ `nodemon`). –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –µ–≥–æ:

```bash
cargo install cargo-watch
```

–¢–µ–ø–µ—Ä—å –∑–∞–π–º–µ–º—Å—è `React-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º`.

–†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º `src/App.jsx`:

```javascript
import React, { useState } from 'react'
// –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∏
// –Ω–∞—à—É —Ñ—É–Ω–∫—Ü–∏—é `greet`
import init, { greet } from '../pkg'

function App() {
 // —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è –∏–º–µ–Ω–∏
 const [name, setName] = useState('')

 // —Ñ—É–Ω–∫—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–º–µ–Ω–∏
 const changeName = ({ target: { value } }) => setName(value)
 // —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
 const sayHello = async (e) => {
   e.preventDefault()
   const trimmed = name.trim()
   if (!trimmed) return
   // –≤—ã–ø–æ–ª–Ω—è–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é
   await init()
   // –≤—ã–∑—ã–≤–∞–µ–º –Ω–∞—à—É —Ñ—É–Ω–∫—Ü–∏—é
   greet(name)
 }

 return (
   <div className='app'>
     <h1>React Rust</h1>
     <form onSubmit={sayHello}>
       <fieldset>
         <label htmlFor='name'>Enter your name</label>
         <input
           type='text'
           id='name'
           value={name}
           onChange={changeName}
           autoFocus
         />
       </fieldset>
       <button>Say hello</button>
     </form>
   </div>
 )
}

export default App
```

–ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–µ–∫—Ç –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:

```bash
yarn start
# or
npm start
```

<img src="https://habrastorage.org/webt/pw/sb/uj/pwsbujkcxpjjajek7zmffcdk9di.png" />
<br />

_–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ_: –∑–¥–µ—Å—å –º–æ–∂–µ—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –æ—à–∏–±–∫–∞ `404 Not Found`, —Å–≤—è–∑–∞–Ω–Ω–∞—è —Å —Ç–µ–º, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –¥–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `pkg`, –≤ –∫–æ—Ç–æ—Ä—É—é –ø–æ–º–µ—â–∞—é—Ç—Å—è —Ñ–∞–π–ª—ã, —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å –ø–æ–º–æ—â—å—é –ø–ª–∞–≥–∏–Ω–∞ `@emily-curry/snowpack-plugin-wasm-pack` (–∏–∑ —ç—Ç–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è `greet`). –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä –∏ –≤—Å–µ –±—É–¥–µ—Ç –æ–∫ üòÉ

<img src="https://habrastorage.org/webt/me/cf/mu/mecfmuq2feikjuo6njsxc5jec0a.png" />
<br />

–í–≤–æ–¥–∏–º –∏–º—è –∏ –Ω–∞–∂–∏–º–∞–µ–º –∫–Ω–æ–ø–∫—É `Say hello`:

<img src="https://habrastorage.org/webt/fe/_u/tj/fe_utjssdcg2e_ies7l5cyh2olo.png" />
<br />

–§—É–Ω–∫—Ü–∏—è `greet`, –Ω–∞–ø–∏—Å–∞–Ω–Ω–∞—è –Ω–∞ `Rust` –∏ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤ `Wasm`, —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ `JS`. –ö—Ä—É—Ç–æ!

–í—ã–ø–æ–ª–Ω—è–µ–º —Å–±–æ—Ä–∫—É –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω–∞:

```bash
yarn build
# or
npm run build
```

<img src="https://habrastorage.org/webt/bk/uv/wd/bkuvwdgi8motdkowg6vcsezjyew.png" />
<br />

–≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `build` —Å–æ –≤—Å–µ–º–∏ —Ñ–∞–π–ª–∞–º–∏ –ø—Ä–æ–µ–∫—Ç–∞ (–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–±–æ—Ä–∫–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é —Ä–∞–∑–¥–µ–ª–∞ `buildOptions` —Ñ–∞–π–ª–∞ `snowpack.config.js`).

–ü–æ—Å–∫–æ–ª—å–∫—É —Ç–∏–ø–æ–º —Å–∫—Ä–∏–ø—Ç–∞, –ø–æ–¥–∫–ª—é—á–∞–µ–º–æ–≥–æ –≤ `index.html`, —è–≤–ª—è–µ—Ç—Å—è `module`, –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç —Å –ø–æ–º–æ—â—å—é —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è `VSCode` —Ç–∏–ø–∞ [`Live Server`](https://marketplace.visualstudio.com/items?itemName=ritwickdey.LiveServer) –Ω–µ –ø–æ–ª—É—á–∏—Ç—Å—è - —Å—Ä–∞–±–æ—Ç–∞–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ [`CORS`](https://developer.mozilla.org/ru/docs/Web/HTTP/CORS).

–ß—Ç–æ –¥–µ–ª–∞—Ç—å? –ü–∏—Å–∞—Ç—å —Å–µ—Ä–≤–µ—Ä? –ï—Å—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç –ø–æ–ª—É—á—à–µ.

–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º [`serve`](https://www.npmjs.com/package/serve) –≥–ª–æ–±–∞–ª—å–Ω–æ:

```bash
yarn global add serve
# or
npm i -g serve
```

–ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–µ–∫—Ç:

```bash
# —Ñ–ª–∞–≥ -s –∏–ª–∏ --single –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –ø—É—Ç–∏
# –±—É–¥—É—Ç –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –∫ index.html
serve -s build
# or without install
npx serve -s build
```

<img src="https://habrastorage.org/webt/d6/1y/au/d61yauesfhsbjeknwe2ams_p7ia.png" />
<br />

–ü–æ–ª—É—á–∞–µ–º –∞–¥—Ä–µ—Å —Å–∞–π—Ç–∞, –ø–µ—Ä–µ—Ö–æ–¥–∏–º –ø–æ –Ω–µ–º—É, –≤–∏–¥–∏–º –Ω–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.

–í–≤–æ–¥–∏–º –∏–º—è, –Ω–∞–∂–∏–º–∞–µ–º `Say hello`, –ø–æ–ª—É—á–∞–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ. –î–∞, –º—ã —Å–¥–µ–ª–∞–ª–∏ —ç—Ç–æ!

–ü–æ–∂–∞–ª—É–π, —ç—Ç–æ –≤—Å–µ, —á–µ–º —è —Ö–æ—Ç–µ–ª –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —Å –≤–∞–º–∏ –≤ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ.

–ù–∞–¥–µ—é—Å—å, –≤–∞–º –±—ã–ª–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ –∏ –≤—ã –Ω–µ –∑—Ä—è –ø–æ—Ç—Ä–∞—Ç–∏–ª–∏ –≤—Ä–µ–º—è.

The End.
